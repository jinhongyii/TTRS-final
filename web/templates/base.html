<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <link href="/static/css/bootstrap-material-design.min.css" rel="stylesheet">

    <script src="/static/js/vue.min.js"></script>
    <script src="/static/js/sha1.min.js"></script>
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/popper.min.js"></script>
    <script src="/static/js/bootstrap-material-design.min.js"></script>
	
  
    {% block head %} <!-- before head  --> {% endblock %}
</head>

<body class="text-center">
<nav class="navbar navbar-expand-sm bg-light navbar-light sticky-top">
    <!--Brand-->
    <a class="navbar-brand ml-3" href="#">
        Logo
        <!-- <img src="" alt="Logo" style="width:40px"> -->
    </a>

    <!--Links-->
    <div class="mr-auto">
        <ul class="nav navbar-nav">
                {% if user %}
                <li class="nav-item">
                    <a class="nav-link" href="/query_ticket">查询车票</a>
                {% endif%}
                {% if admin %}
                <li class="nav-item">
                    <a class="nav-link" href="/admin">管理</a>
                </li>
                {% endif %}
        </ul>
    </div>

    <!--Login or User logo-->
    <div class="ml-auto">
        <div class="ml-3">
            <ul class="nav navbar-nav">
                {% if user %}
                <li class="nav-item dropdown">
                    <a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle"
                       data-toggle="dropdown"
                       href="#"
                       id="navbarDropdown" role="button">
                        {{ user }}
                    </a>
                    <div aria-labelledby="navbarDropdown" class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="/profile">Profile</a>
                        <a class="dropdown-item" href="/settings">Settings</a>
                        <div id="logout">
                            <a class="dropdown-item" v-on:click="logout">Logout</a>
                        </div>

                        <script>
                            new Vue({
                                el: '#logout',
                                methods: {
                                    logout: function (event) {
                                        $.ajax({
                                            type: 'POST',
                                            url: '/api/logout',
                                            success: function (data) {
                                                return location.assign('/');
                                            },
                                            error: function (XMLHttpRequest, textStatus) {
                                                console.log(XMLHttpRequest);
                                                alert(XMLHttpRequest.responseText);
                                            }
                                        });
                                    }
                                }
                            });
                        </script>
                    </div>
                </li>

                {% else %}
                <div class="px-2">
                    <a class="btn btn-outline-primary" href="/login" role="button">登录</a>
                    <a class="btn btn-outline-primary" href="/register" role="button">注册</a>
                </div>
                {% endif %}
            </ul>
        </div>
    </div>
</nav>

{% block content %} {% endblock %}

</body>

</html>